/* ================================
   ENERPREDICT UI THEME (full replacement)
   - Improved responsiveness, appliance UI fixes
   - Validation notes, polished result card & gauge
   - Debug/pre and small helper classes
================================ */

:root{
  --bg: #FFF5EB;
  --card: #ffffff;
  --accent: #FF6B00;
  --accent-dark: #D45500;
  --nav-blue: #0A3D62;
  --muted: #6b7280;
  --green: #0E9F6E;
  --danger: #d62828;
  --ok: #2a9d8f;
  --surface: #f9f7f5;
  --shadow: rgba(0,0,0,0.08);
}

/* base */
*{ box-sizing: border-box; font-family: "Poppins", sans-serif; }
html,body{ height:100%; margin:0; background:var(--bg); color:#111; -webkit-font-smoothing:antialiased; }

/* NAVBAR */
.nav{
  display:flex; justify-content:space-between; align-items:center;
  padding:14px 22px;
  background: linear-gradient(90deg,var(--nav-blue),var(--accent));
  color:#fff; box-shadow:0 3px 8px rgba(0,0,0,0.15);
}
.brand{ color:#fff; font-weight:700; font-size:22px; text-decoration:none; }
.nav-links a{ margin-left:16px; text-decoration:none; color:#fff; font-weight:500; opacity:0.95; }
.nav-links a:hover{ opacity:1; }

/* main container */
.container{ max-width:1100px; margin:26px auto; padding:0 18px; }

/* card */
.card{
  background:var(--card); padding:20px; border-radius:14px;
  box-shadow:0 10px 25px var(--shadow); margin-top:20px;
  transition:transform .18s ease, box-shadow .18s ease;
}
.card:hover{ transform:translateY(-5px); box-shadow:0 16px 30px rgba(0,0,0,0.12); }

/* grid utilities */
.card-grid{ display:grid; grid-template-columns: repeat(auto-fit,minmax(240px,1fr)); gap:20px; margin-top:24px; }

/* buttons */
.btn{
  background:var(--accent); color:#fff; padding:10px 16px; border-radius:10px;
  border:none; cursor:pointer; font-size:15px; font-weight:600; transition:all .14s;
}
.btn:hover{ background:var(--accent-dark); transform:translateY(-2px); }
.btn.secondary{ background:#fff; border:2px solid var(--accent); color:var(--accent); }
.btn.secondary:hover{ background:var(--accent); color:#fff; }

/* global form inputs */
input, select, textarea{
  padding:10px; border-radius:10px; border:2px solid #f0f0f0; font-size:15px; background:#fff;
}
input:focus, select:focus, textarea:focus{
  border-color:var(--accent); outline:none; box-shadow:0 0 8px rgba(255,107,0,0.12);
}

/* prediction-page wide layout */
body.prediction-page .container { max-width:1500px; padding:0 30px; }
body.prediction-page .card { padding:28px; max-width:none; }
body.prediction-page .predict-grid {
  display:grid; grid-template-columns: 2fr 1fr; gap:36px; align-items:start;
}

/* form basics */
.predict-form label{ display:block; margin-top:12px; font-weight:600; color:#333; }
.predict-form input[type="number"], .predict-form input[type="text"], .predict-form select {
  width:100%; padding:10px 12px; border-radius:10px; border:1px solid #f0f0f0; margin-top:6px; box-sizing:border-box;
}

/* inline field helpers */
.field-inline{ display:flex; align-items:center; gap:8px; }
.calculated-pill{ display:inline-block; background:#eef7ff; color:#2266aa; padding:3px 6px; border-radius:8px; font-size:12px; margin-left:8px; }

/* result + history cards */
.result-card{ padding:14px; border-radius:12px; background:var(--card); box-shadow:0 6px 18px rgba(0,0,0,0.04); }

/* spinner */
.spinner{ display:inline-block; width:18px; height:18px; border:3px solid rgba(0,0,0,0.08); border-top-color:var(--accent); border-radius:50%; animation:spin .9s linear infinite; vertical-align:middle; margin-left:8px; }
@keyframes spin{ to { transform:rotate(360deg); } }

/* field-block (used by dynamic form builder) */
.field-block{ margin-top:12px; display:block; }
.field-block label{ font-weight:600; color:#333; display:block; margin-bottom:6px; }

/* fixed row for appliance (input + select) */
.field-block .appliance-row {
  display:flex; gap:10px; align-items:center; flex-wrap:nowrap;
}

/* ensure the number input grows and doesn't shrink too small */
.field-block input[type="number"]{
  min-width:150px;
  flex:1 1 auto;
  padding:9px 10px;
  border-radius:8px; border:1px solid #e9e6e6;
}

/* the small select next to inputs (count/power) */
.field-block select {
  padding:8px 10px; border-radius:8px; border:1px solid #e9e6e6; background:#fff;
  min-width:120px;
}

/* help text and validation notes */
.field-note{ margin-top:6px; font-size:13px; color:var(--muted); }
.help-small{ font-size:13px; color:var(--muted); margin-top:6px; }

/* small action / tooltip */
.small-muted{ color:#666; font-size:13px; }
.input-range{ font-size:12px; color:#666; margin-top:4px; }
.range-warning{ color:#b86100 !important; font-weight:600; }
.range-extreme{ color:var(--danger) !important; font-weight:700; }

/* debug pre */
#featureVectorDebug{ max-height:220px; overflow:auto; font-size:12px; background:#fbfbfb; border-radius:8px; padding:8px; }

/* result card hover polish */
.result-card{ transition: box-shadow .2s ease, transform .08s ease; }
.result-card:hover{ transform:translateY(-2px); box-shadow:0 10px 30px rgba(0,0,0,0.06); }

/* chart styling */
canvas{ border-radius:12px; background:transparent; }

/* small helper buttons */
.suggest-btn{ background:transparent; border:none; color:var(--accent); cursor:pointer; font-weight:700; padding:6px; border-radius:6px; }
.fix-slot{ display:inline-block; margin-left:8px; vertical-align:middle; }
.tooltip-slot{ display:inline-block; margin-left:8px; vertical-align:middle; font-size:13px; color:#666; cursor:help; }

/* appliance tile look (optional grouping) */
#appliance-list .appliance-row {
  background:var(--surface); padding:8px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.03);
}

/* result pretty styles (main prediction shown) */
.prediction-value {
  font-size:20px; font-weight:800; color:var(--accent);
}
.prediction-sub { color:var(--muted); font-size:13px; margin-top:6px; }

/* gauge helpers (conic-gradient style circle) */
.gauge {
  width:88px; height:88px; border-radius:50%;
  display:inline-block; margin-right:12px; vertical-align:middle;
  background: conic-gradient(var(--accent) 40%, #eee 40%); /* default slice */
}

/* status badges */
.badge { display:inline-block; padding:6px 8px; border-radius:8px; font-size:13px; }
.badge-ok { background: rgba(42,157,143,0.12); color:var(--ok); border:1px solid rgba(42,157,143,0.14); }
.badge-warn { background: rgba(184,97,0,0.06); color:#b86100; border:1px solid rgba(184,97,0,0.08); }

/* responsive adjustments */
@media (max-width:980px){
  body.prediction-page .predict-grid { grid-template-columns: 1fr; gap:18px; }
  .container{ padding:12px; }
  .field-block input[type="number"]{ min-width:120px; }
}

/* very small screens compact */
@media (max-width:520px){
  .field-block .appliance-row{ flex-wrap:wrap; gap:8px; }
  .field-block select{ min-width:100%; width:100%; }
  .field-block input[type="number"]{ width:100%; min-width:unset; }
}

/* validation states (colored notes, not blocking) */
.v-note-error { color: var(--danger); font-weight:600; }
.v-note-ok { color: var(--ok); font-weight:600; }

/* make sure suggestion buttons don't overflow */
.field-block .suggest-btn { margin-left:6px; }

/* subtle focus for inputs with suggestion */
.field-block input:focus { box-shadow: 0 0 8px rgba(255,107,0,0.10); border-color: var(--accent); }

/* small utility classes */
.hidden { display:none !important; }
.muted { color:var(--muted); font-size:13px; }

/* debug / development helpers (can remove later) */
.dev-outline *[data-dev] { outline: 1px dashed rgba(0,0,0,0.06); }

/* End of style.css */
/* Appliance icon + collapsible details styles */
.appliance-icon svg{ display:block; width:20px; height:20px; }
.appliance-row { display:flex; gap:10px; align-items:center; }
#appliance-list .field-block { margin-bottom:10px; }
details[open] > summary { font-weight:800; color:#333; }
details summary { list-style:none; outline:none; }
details summary::-webkit-details-marker { display:none; }
details { transition: all .12s ease; }
details[open] { box-shadow: 0 6px 18px rgba(0,0,0,0.04); border-radius:8px; }
details summary { padding:6px 4px; }

/* ----------------
   Dark Mode (append)
   ---------------- */

/* dark-mode variables — use these to override site colors */
:root {
  --bg: #FFF5EB;          /* light */
  --card: #ffffff;
  --accent: #FF6B00;
  --nav-blue: #0A3D62;
  --muted: #6b7280;
}

/* DARK THEME: add `.dark-theme` on body to enable */
body.dark-theme {
  --bg: #0b0f12;
  --card: #0f1416;
  --accent: #ff9a3c;
  --accent-dark: #ff7a00;
  --nav-blue: #072235;
  --muted: #9aa6b2;
  --green: #2dd4bf;
  --danger: #ff6b6b;
  --surface: #0b1113;
  --shadow: rgba(0,0,0,0.6);
  color: #e6eef3;
  background: linear-gradient(180deg,#080a0b,#101419);
}

/* switch core elements */
body.dark-theme .nav { background: linear-gradient(90deg,#062235,#5d2b00); box-shadow:0 6px 18px rgba(0,0,0,0.6); }
body.dark-theme .card { background: var(--card); box-shadow: 0 10px 30px rgba(0,0,0,0.65); color: #e6eef3; }
body.dark-theme input, body.dark-theme select, body.dark-theme textarea {
  background: #0b1214; color:#e6eef3; border:1px solid rgba(255,255,255,0.06);
}
body.dark-theme .result-card { background: #0f1517; color:#e6eef3; box-shadow:0 8px 24px rgba(0,0,0,0.6); }
body.dark-theme .small-muted, body.dark-theme .help-small, body.dark-theme .input-range { color: #9aa6b2; }

/* buttons */
body.dark-theme .btn { background: var(--accent); color:#0f1416; box-shadow: none; }
body.dark-theme .btn.secondary { background: transparent; color: var(--accent); border-color: rgba(255,154,60,0.14); }

/* cards / backgrounds */
body.dark-theme .predict-wrapper { background: transparent; }
body.dark-theme canvas { filter: none; }

/* tweak placeholders (so they don't glow too bright) */
body.dark-theme ::placeholder { color: rgba(255,255,255,0.35); }

/* subtle transitions */
body, .card, .result-card, input, select, textarea { transition: background-color .18s ease, color .18s ease, box-shadow .18s ease, border-color .18s ease; }

/* nav toggle position helper (if we inject the button) */
.theme-toggle-btn {
  display:inline-flex;
  align-items:center;
  gap:8px;
  border-radius:8px;
  padding:6px 8px;
  background: rgba(255,255,255,0.06);
  color: #fff;
  border:1px solid rgba(255,255,255,0.06);
  cursor:pointer;
  font-weight:700;
}
body.dark-theme .theme-toggle-btn { background: rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.04); }

/* icon sizing */
.theme-toggle-btn svg { width:18px;height:18px; display:block; }

/* small aria-pressed state */
.theme-toggle-btn[aria-pressed="true"] { box-shadow: 0 6px 20px rgba(0,0,0,0.4) inset; }

/* details: make dark-friendly too */
body.dark-theme details[open] { background: rgba(255,255,255,0.02); border-color: rgba(255,255,255,0.04); }
/* ---------- Dark-mode / details / appliance fixes (append) ---------- */

/* Make sure details stays inside the card and doesn't look like a page-wide band */
details {
  position: relative;        /* ensure it's positioned relative to flow */
  z-index: 2;                /* sit above background but below nav */
  width: 100%;
  box-sizing: border-box;
}

/* When open, keep the details container's background the same as card */
details[open] {
  background: var(--card);
  border: 1px solid rgba(0,0,0,0.06);
  padding: 12px;
  margin-top: 8px;
  border-radius: 10px;
  box-shadow: 0 10px 28px rgba(0,0,0,0.06);
}

/* Appliance container must not escape layout; avoid large vertical overlay */
#appliance-list {
  max-width: 100%;
  margin: 0;
}

/* Appliance row should visually be a small card within the details panel */
.appliance-row {
  background: var(--card);
  padding: 8px;
  border-radius: 8px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.04);
}

/* In dark theme, appliance-row should use the dark card color (not the page black) */
body.dark-theme .appliance-row {
  background: var(--card); /* var(--card) is set for dark theme earlier */
  box-shadow: 0 6px 20px rgba(0,0,0,0.6);
}

/* Inputs look — don't let them go fully black; use the card-contrast color */
body.dark-theme input,
body.dark-theme select,
body.dark-theme textarea {
  background: rgba(255,255,255,0.03); /* slight contrast vs page background */
  color: #e6eef3;
  border-color: rgba(255,255,255,0.06);
}

/* Ensure placeholder text is slightly dimmer */
body.dark-theme ::placeholder { color: rgba(255,255,255,0.28); }

/* Prevent the expanded details from overlapping the NAV by adjusting stacking */
.nav { position: relative; z-index: 999; }         /* nav stays on top */
body.dark-theme .predict-wrapper { position: relative; z-index: 5; }

/* If the details block has grown taller than viewport, allow scroll inside card rather than create page overlay */
details[open] {
  max-height: calc(75vh);       /* keep it inside viewport */
  overflow: auto;               /* scroll the details content if needed */
  -webkit-overflow-scrolling: touch;
}

/* Tweak to avoid the large dark band when details open near top of page:
   ensure the details has a subtle top/bottom margin so it's visually anchored */
details[open] { margin-top: 12px; margin-bottom: 12px; }

/* make the appliance icon background subtle in dark theme */
.appliance-icon {
  background: rgba(0,0,0,0.06);
  padding:6px; border-radius:8px;
}
body.dark-theme .appliance-icon { background: rgba(255,255,255,0.03); }

/* small responsive tweak: shrink detail max-height on small screens */
@media (max-width:520px){
  details[open] { max-height: calc(60vh); }
}
